<?php
session_start();
include "connection.php";

// Check admin login
if(!isset($_SESSION['is_admin']) || $_SESSION['is_admin'] != 1){
    header("Location: admin_login.php");
    exit();
}

if($_SERVER['REQUEST_METHOD'] == 'POST'){
    $product_name  = $_POST['product_name'];
    $price         = $_POST['price'];
    $description   = $_POST['description'];

    // Upload Image
    $image_name = $_FILES['image']['name'];
    $temp_name  = $_FILES['image']['tmp_name'];
    $folder     = "uploads/" . $image_name;

    move_uploaded_file($temp_name, $folder);

    $query = "INSERT INTO products(product_name, price, description, image) 
              VALUES('$product_name', '$price', '$description', '$image_name')";
    mysqli_query($conn, $query);

    echo "<script>alert('Product Added Successfully!');window.location='admindeshboard.php';</script>";
}
?>

<!DOCTYPE html>
<html>
<head>
<title>Add Product</title>
</head>
<body>

<h2>Add New Product</h2>

<form method="POST" enctype="multipart/form-data">
    <label>Product Name:</label><br>
    <input type="text" name="product_name" required><br><br>

    <label>Price:</label><br>
    <input type="number" name="price" required><br><br>

    <label>Description:</label><br>
    <textarea name="description" rows="4"></textarea><br><br>

    <label>Product Image:</label><br>
    <input type="file" name="image" required><br><br>

    <button type="submit">Add Product</button>
</form>

</body>
</html>
